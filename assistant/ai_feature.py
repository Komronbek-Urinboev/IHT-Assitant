import difflib
import google.generativeai as genai
from bot_instance import *
import time
import random

from ban import blacklist
user_timers = {}

# –£–∫–∞–∂–∏ —Å–≤–æ–π API-–∫–ª—é—á Gemini
GEMINI_API_KEY = "AIzaSyBQO89TC_kEQwSt7lqQJIwy7m5yaCw3y2g"
genai.configure(api_key=GEMINI_API_KEY)


# –õ–æ–∫–∞–ª—å–Ω–∞—è –±–∞–∑–∞ –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
FAQ = {
    "—á—Ç–æ —ç—Ç–æ –∑–∞ –±–æ—Ç": "–≠—Ç–æ –º–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –∫–æ–º–∞–Ω–¥–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–∑ –∫–ª—É–±–∞ IHT BotLab.",
    "–∫—Ç–æ —Å–æ–∑–¥–∞–ª —ç—Ç–æ—Ç –±–æ—Ç": "–ë–æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–æ–º–∞–Ω–¥–æ–π –∏–∑ –∫–ª—É–±–∞ IHT BotLab, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞.",
    "–∫—Ç–æ —Å–æ–∑–¥–∞—Ç–µ–ª—å —ç—Ç–æ–≥–æ –±–æ—Ç–∞": "–ë–æ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –∫–æ–º–∞–Ω–¥–æ–π –∏–∑ –∫–ª—É–±–∞ IHT BotLab, –∞ —Ç–∞–∫–∂–µ –¥—Ä—É–≥–∏–º–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞.",
    "–Ω–∞ –∫–∞–∫–æ–º —è–∑—ã–∫–µ –Ω–∞–ø–∏—Å–∞–Ω –±–æ—Ç": "–ë–æ—Ç –Ω–∞–ø–∏—Å–∞–Ω –Ω–∞ —è–∑—ã–∫–µ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ telebot.",
    "–∫–∞–∫ —Å–≤—è–∑–∞—Ç—å—Å—è —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –±–æ—Ç–∞": "–í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç—å –≤ —á–∞—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∏–ª–∏ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É: @LenovoFlex14 @Komronbek_Urinboev",
    "–∫–∞–∫ —É–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ": "–î–ª—è —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–≤—è–∂–∏—Ç–µ—Å—å —Å @Komronbek_Urinboev.",
    "–∫–∞–∫ –ø–æ–¥–∞—Ç—å –∏–¥–µ—é": "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É /su_ideas –∏ —Å–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏.",
    "–∫—Ç–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏—è": "–í—Å–µ —Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –°–Æ.",
    "iht botlab": "IHT BotLab ‚Äî —ç—Ç–æ –∫–ª—É–±, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è —É—á–∞—â–∏—Ö—Å—è, –∂–µ–ª–∞—é—â–∏—Ö –∏–∑—É—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å Telegram-–±–æ—Ç–æ–≤.\n–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è, –≥–¥–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Å–≤–∞–∏–≤–∞—é—Ç –æ—Å–Ω–æ–≤—ã Python –∏ —Ä–∞–±–æ—Ç—É —Å Telegram API.\n\nüîπ –ß–µ–º—É –æ–±—É—á–∞—é—Ç –≤ –∫–ª—É–±–µ?\n–û—Å–Ω–æ–≤—ã Python ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ü–∏–∫–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏.\n–†–∞–±–æ—Ç–∞ —Å Telegram API ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏.\n–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî JSON –∏ —Ä–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.\n–°–æ–∑–¥–∞–Ω–∏–µ UI ‚Äî inline-–∫–Ω–æ–ø–∫–∏, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.\n–†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞ ‚Äî —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ Telegram.\n–•–æ—Å—Ç–∏–Ω–≥ ‚Äî –∑–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö.",
    "–∫–ª—É–± iht botlab": "IHT BotLab ‚Äî —ç—Ç–æ –∫–ª—É–±, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è —É—á–∞—â–∏—Ö—Å—è, –∂–µ–ª–∞—é—â–∏—Ö –∏–∑—É—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å Telegram-–±–æ—Ç–æ–≤.\n–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è, –≥–¥–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Å–≤–∞–∏–≤–∞—é—Ç –æ—Å–Ω–æ–≤—ã Python –∏ —Ä–∞–±–æ—Ç—É —Å Telegram API.\n\nüîπ –ß–µ–º—É –æ–±—É—á–∞—é—Ç –≤ –∫–ª—É–±–µ?\n–û—Å–Ω–æ–≤—ã Python ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ü–∏–∫–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏.\n–†–∞–±–æ—Ç–∞ —Å Telegram API ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏.\n–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî JSON –∏ —Ä–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.\n–°–æ–∑–¥–∞–Ω–∏–µ UI ‚Äî inline-–∫–Ω–æ–ø–∫–∏, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.\n–†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞ ‚Äî —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ Telegram.\n–•–æ—Å—Ç–∏–Ω–≥ ‚Äî –∑–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö.",
    "—á—Ç–æ —Ç–∞–∫–æ–µ iht botlab": "IHT BotLab ‚Äî —ç—Ç–æ –∫–ª—É–±, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è —É—á–∞—â–∏—Ö—Å—è, –∂–µ–ª–∞—é—â–∏—Ö –∏–∑—É—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å Telegram-–±–æ—Ç–æ–≤.\n–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è, –≥–¥–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Å–≤–∞–∏–≤–∞—é—Ç –æ—Å–Ω–æ–≤—ã Python –∏ —Ä–∞–±–æ—Ç—É —Å Telegram API.\n\nüîπ –ß–µ–º—É –æ–±—É—á–∞—é—Ç –≤ –∫–ª—É–±–µ?\n–û—Å–Ω–æ–≤—ã Python ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ü–∏–∫–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏.\n–†–∞–±–æ—Ç–∞ —Å Telegram API ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏.\n–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî JSON –∏ —Ä–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.\n–°–æ–∑–¥–∞–Ω–∏–µ UI ‚Äî inline-–∫–Ω–æ–ø–∫–∏, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.\n–†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞ ‚Äî —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ Telegram.\n–•–æ—Å—Ç–∏–Ω–≥ ‚Äî –∑–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö.",
    "–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª—É–±–µ iht botlab": "IHT BotLab ‚Äî —ç—Ç–æ –∫–ª—É–±, —Å–æ–∑–¥–∞–Ω–Ω—ã–π –¥–ª—è —É—á–∞—â–∏—Ö—Å—è, –∂–µ–ª–∞—é—â–∏—Ö –∏–∑—É—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å Telegram-–±–æ—Ç–æ–≤.\n–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è, –≥–¥–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –æ—Å–≤–∞–∏–≤–∞—é—Ç –æ—Å–Ω–æ–≤—ã Python –∏ —Ä–∞–±–æ—Ç—É —Å Telegram API.\n\nüîπ –ß–µ–º—É –æ–±—É—á–∞—é—Ç –≤ –∫–ª—É–±–µ?\n–û—Å–Ω–æ–≤—ã Python ‚Äî –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, —Ü–∏–∫–ª—ã, —Ñ—É–Ω–∫—Ü–∏–∏.\n–†–∞–±–æ—Ç–∞ —Å Telegram API ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞–º–∏.\n–•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö ‚Äî JSON –∏ —Ä–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.\n–°–æ–∑–¥–∞–Ω–∏–µ UI ‚Äî inline-–∫–Ω–æ–ø–∫–∏, –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.\n–†–∞–±–æ—Ç–∞ —Å –º–µ–¥–∏–∞ ‚Äî —Ñ–æ—Ç–æ, –≤–∏–¥–µ–æ, –¥–æ–∫—É–º–µ–Ω—Ç—ã –≤ Telegram.\n–•–æ—Å—Ç–∏–Ω–≥ ‚Äî –∑–∞–ø—É—Å–∫ –±–æ—Ç–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞—Ö.",
#    "–∫—Ç–æ —Ç–∞–∫–æ–π —É—Ä–∏–Ω–±–æ–µ–≤ –∫–æ–º—Ä–æ–Ω–±–µ–∫": "–£—Ä–∏–Ω–±–æ–µ–≤ –ö–æ–º—Ä–æ–Ω–±–µ–∫ - 1 –∏–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —ç—Ç–æ–≥–æ –±–æ—Ç–∞\n–Ø —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å –¥–µ—Ç—Å—Ç–≤–∞ —É–≤–ª–µ–∫–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã. –°–µ–π—á–∞—Å —è —É—á—É—Å—å –≤ INTERNATIONAL HOUSE-TASHKENT ACADEMIC LYCEUM –≤ –≥—Ä—É–ø–ø–µ 1-–¢–ù-3 –∏ –≤–æ–∑–≥–ª–∞–≤–ª—è—é –∫–ª—É–± IHT BotLab. –Ø –∞–∫—Ç–∏–≤–Ω–æ —Å–æ–∑–¥–∞—é Telegram-–±–æ—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–Ω–µ–¥—Ä—è—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –≤ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã.",
#    "—É—Ä–∏–Ω–±–æ–µ–≤ –∫–æ–º—Ä–æ–Ω–±–µ–∫": "–£—Ä–∏–Ω–±–æ–µ–≤ –ö–æ–º—Ä–æ–Ω–±–µ–∫ - 1 –∏–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —ç—Ç–æ–≥–æ –±–æ—Ç–∞\n–Ø —Ü–µ–ª–µ—É—Å—Ç—Ä–µ–º–ª–µ–Ω–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å –¥–µ—Ç—Å—Ç–≤–∞ —É–≤–ª–µ–∫–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç—ã. –°–µ–π—á–∞—Å —è —É—á—É—Å—å –≤ INTERNATIONAL HOUSE-TASHKENT ACADEMIC LYCEUM –≤ –≥—Ä—É–ø–ø–µ 1-–¢–ù-3 –∏ –≤–æ–∑–≥–ª–∞–≤–ª—è—é –∫–ª—É–± IHT BotLab. –Ø –∞–∫—Ç–∏–≤–Ω–æ —Å–æ–∑–¥–∞—é Telegram-–±–æ—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–Ω–µ–¥—Ä—è—é –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç –≤ —Å–≤–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã.",
    "—Å–∏–¥–∏–∫–æ–≤ —Ö–∞–±–∏–±—É–ª–ª–æ": "–°–∏–¥–∏–∫–æ–≤ –•–∞–±–∏–±—É–ª–ª–æ - 1 –∏–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —ç—Ç–æ–≥–æ –±–æ—Ç–∞\n–Ø —É–ø–æ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å –¥–µ—Ç—Å—Ç–≤–∞ —É–≤–ª–µ–∫–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º,  –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –¥–∏–∑–∞–π–Ω—É –∏  —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. –°–µ–π—á–∞—Å —è —É—á—É—Å—å –≤ INTERNATIONAL HOUSE-TASHKENT ACADEMIC LYCEUM –≤ –≥—Ä—É–ø–ø–µ 1-–¢–ù-3 –∏ –≤–æ–∑–≥–ª–∞–≤–ª—è—é –∫–ª—É–± IHT BotLab. –Ø –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—é —É—á–∞—Å—Ç–∏—è –≤ —Å–æ–∑–¥–∞—é Telegram-–±–æ—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–≤–µ—á–∞—é –∑–∞ –º–µ–¥–∏–∞ —á–∞—Å—Ç—å –≤ –∫–ª—É–±–µ IHT BotLab",
    "–∫—Ç–æ —Ç–∞–∫–æ–π —Å–∏–¥–∏–∫–æ–≤ —Ö–∞–±–∏–±—É–ª–ª–æ": "–°–∏–¥–∏–∫–æ–≤ –•–∞–±–∏–±—É–ª–ª–æ - 1 –∏–∑ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —ç—Ç–æ–≥–æ –±–æ—Ç–∞\n–Ø —É–ø–æ—Ä–Ω—ã–π —á–µ–ª–æ–≤–µ–∫, –∫–æ—Ç–æ—Ä—ã–π —Å –¥–µ—Ç—Å—Ç–≤–∞ —É–≤–ª–µ–∫–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º,  –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–º—É –¥–∏–∑–∞–π–Ω—É –∏  —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤. –°–µ–π—á–∞—Å —è —É—á—É—Å—å –≤ INTERNATIONAL HOUSE-TASHKENT ACADEMIC LYCEUM –≤ –≥—Ä—É–ø–ø–µ 1-–¢–ù-3 –∏ –≤–æ–∑–≥–ª–∞–≤–ª—è—é –∫–ª—É–± IHT BotLab. –Ø –∞–∫—Ç–∏–≤–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—é —É—á–∞—Å—Ç–∏—è –≤ —Å–æ–∑–¥–∞—é Telegram-–±–æ—Ç–æ–≤, —Ä–∞–±–æ—Ç–∞—é —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–≤–µ—á–∞—é –∑–∞ –º–µ–¥–∏–∞ —á–∞—Å—Ç—å –≤ –∫–ª—É–±–µ IHT BotLab"

}

# –§—É–Ω–∫—Ü–∏—è –ø–æ–∏—Å–∫–∞ –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ—Ö–æ–∂–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
def find_best_match(user_question: str):
    questions = list(FAQ.keys())
    matches = difflib.get_close_matches(user_question, questions, n=1, cutoff=0.7)
    return matches[0] if matches else None



# –§—É–Ω–∫—Ü–∏—è —Ä–∞–∑–±–∏–µ–Ω–∏—è –¥–ª–∏–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ —á–∞—Å—Ç–∏
def split_message(text, max_length=4000):
    return [text[i:i+max_length] for i in range(0, len(text), max_length)]

# –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /ask
@bot.message_handler(commands=['ask'])
def ask_ai(message):
    if message.from_user.id in blacklist:
        return  # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –∫–æ–º–∞–Ω–¥—É, –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –±–∞–Ω–µ
    user_id = message.from_user.id
    current_time = time.time()

    if user_id in user_timers and current_time - user_timers[user_id] < 10:
        return  # –ü—Ä–æ—Å—Ç–æ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ

    user_timers[user_id] = current_time
    user_text = message.text.replace("/ask", "").strip().lower()
    if not user_text:
        bot.reply_to(message, "–í—ã –Ω–µ –≤–≤–µ–ª–∏ –≤–æ–ø—Ä–æ—Å. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: `/ask –≤–∞—à –≤–æ–ø—Ä–æ—Å`")
        return

    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º progress bar
    progress_msg = bot.send_message(message.chat.id, "‚åõ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞: [0%]")
    progress_steps = [
        "‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 0%",
        "‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 5%",
        "‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 14%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 16%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 22%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 28%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 37%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 39%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 43%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ±‚ñ±‚ñ± 48%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ± 55%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ± 63%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ± 69%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ±‚ñ± 75%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ± 79%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ± 80%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ±‚ñ± 85%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ± 92%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ± 94%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ± 99%",
        "‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞‚ñ∞ 100%"
    ]


    for step in progress_steps:
        time.sleep(random.uniform(0.1, 0.3))  # –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –æ—Ç 0.1 –¥–æ 1 —Å–µ–∫—É–Ω–¥—ã
        bot.edit_message_text(f"‚åõ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞: {step}", chat_id=message.chat.id,
                              message_id=progress_msg.message_id)

    # –ò—â–µ–º –æ—Ç–≤–µ—Ç –≤ FAQ
    best_match = find_best_match(user_text)
    if best_match:
        bot.edit_message_text(f"‚úÖ –û—Ç–≤–µ—Ç –Ω–∞–π–¥–µ–Ω:\n {FAQ[best_match]}", chat_id=message.chat.id,
                              message_id=progress_msg.message_id)
        return

    # –ï—Å–ª–∏ –≤–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –ò–ò
    try:
        model = genai.GenerativeModel("gemini-2.0-flash")
        response = model.generate_content(user_text)
        response_text = response.text

        # –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç –¥–ª–∏–Ω–Ω–µ–µ 4000 —Å–∏–º–≤–æ–ª–æ–≤, —Ä–∞–∑–±–∏–≤–∞–µ–º –µ–≥–æ –Ω–∞ —á–∞—Å—Ç–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–æ—á–µ—Ä–µ–¥–Ω–æ
        parts = split_message(response_text)
        bot.edit_message_text(f"‚úÖ –û—Ç–≤–µ—Ç: {parts[0]}", chat_id=message.chat.id,
                              message_id=progress_msg.message_id)
        for part in parts[1:]:
            bot.send_message(message.chat.id, part)

    except Exception as e:
        bot.edit_message_text("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.", chat_id=message.chat.id,
                              message_id=progress_msg.message_id)
        print(f"–û—à–∏–±–∫–∞: {e}")
print("–ú–æ–¥—É–ª—å ai_feature –∑–∞–≥—Ä—É–∂–µ–Ω")